## Hack Steps

1. Fetch the forgot-password page
2. Extract the csrf token and session cookie
3. Make a forgot-password request for carlos
4. Inject an operator and payload into the login JSON object to determine the length of the unknown field name
5. Modify the payload to brute force the field name
6. Modify the payload to determine the length of the field value
7. Modify the payload to brute force the field value
8. Fetch the forgot-password page with the field name and its value as a query pararmeter
9. Extract the csrf token and session cookie
10. Make a reset password request for carlos
11. Login as carlos with the new password
12. Fetch the carlos profile

## Run Script

1. Change the URL of the lab
2. You may need to change the field number you extract depending on the lab setup. Either field 3 or field 4 should work
3. Start script
```
~$ cargo run
```

## Expected Output

```
‚¶ó#‚¶ò Injection point: login JSON object
‚¶ó1‚¶ò Fetching the forgot-password page.. OK
‚¶ó2‚¶ò Extracting the csrf token and session cookie.. OK
‚¶ó3‚¶ò Sending a reset password request for carlos.. OK
‚¶ó4‚¶ò Determining the length of the 3rd field..
‚ùØ‚ùØ Checking if length =  5
‚ùØ‚ùØ Checking if length =  7
        .........
‚ùØ‚ùØ Checking if length =  13 [ Correct length: 13 ]
‚¶ó5‚¶ò Brute force the field name.. (0%)
‚¶ó5‚¶ò Brute force the field name.. (47%): r s t w T  e
‚¶ó5‚¶ò Brute force the field name.. (76%): res t wdT ken
                .........
‚¶ó5‚¶ò Brute force the field name.. (100%): resetPwdToken
‚¶ó6‚¶ò Determining the length of the 3rd field value..
‚ùØ‚ùØ Checking if length =  4
‚ùØ‚ùØ Checking if length =  9
                .........
‚ùØ‚ùØ Checking if length =  16 [ Correct length: 16 ]
‚¶ó7‚¶ò Brute force the field value.. (0%)
‚¶ó7‚¶ò Brute force the field value.. (43%): 8  7  1 6   2 ad
‚¶ó7‚¶ò Brute force the field value.. (75%): 8 e7 21 61fc2 ad
                .........
‚¶ó7‚¶ò Brute force the field value.. (100%): 86e7721561fc20ad
‚¶ó8‚¶ò Fetching the forgot-password page with the field name and its value as a query pararmter.. OK
‚¶ó9‚¶ò Extracting the csrf token and session cookie.. OK
‚¶ó10‚¶ò Reseting carlos password to hacked.. OK
‚¶ó11‚¶ò Logging in as the carlos.. OK
‚¶ó12‚¶ò Fetching the carlos profile.. OK
üóπ The lab should be marked now as solved
```
